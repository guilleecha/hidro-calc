# ğŸ¨ Diagramas Visuales - Arquitectura HidroCalc v2.0

## 1. DIAGRAMA ENTIDAD-RELACIÃ“N (ERD)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           PROJECTS                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ PK: id                             â•‘
â•‘ name (UNIQUE)                      â•‘
â•‘ description                        â•‘
â•‘ location                           â•‘
â•‘ country, region, timezone          â•‘
â•‘ owner_id                           â•‘
â•‘ is_active                          â•‘
â•‘ created_at, updated_at             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â–²
           â”‚ 1:N
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚      WATERSHEDS                 â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ PK: id                          â”‚  â”‚
â”‚ FK: project_id â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ name                            â”‚
â”‚ description                     â”‚
â”‚ area_hectareas          â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tc_horas                        â”‚   â”‚
â”‚ nc_scs                          â”‚   â”‚
â”‚ latitude, longitude, elevation  â”‚   â”‚
â”‚ c_racional                      â”‚   â”‚
â”‚ metadata (JSON)                 â”‚   â”‚
â”‚ created_at, updated_at          â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
             â”‚ 1:N                     â”‚
             â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚                         â”‚        â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        â”‚
â”‚   DESIGN_STORMS        â”‚    â”‚        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚        â”‚
â”‚ PK: id                 â”‚    â”‚        â”‚
â”‚ FK: watershed_id â—„â”€â”€â”€â”€â”€â”˜    â”‚        â”‚
â”‚ name                   â”‚         â”‚
â”‚ description            â”‚         â”‚
â”‚ return_period_years    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ Para anÃ¡lisis
â”‚ duration_hours         â”‚         â”‚     comparativo
â”‚ total_rainfall_mm      â”‚         â”‚
â”‚ distribution_type      â”‚         â”‚
â”‚ initial_abstraction_mm â”‚         â”‚
â”‚ storage_parameter_mm   â”‚         â”‚
â”‚ time_step_minutes      â”‚         â”‚
â”‚ metadata (JSON)        â”‚         â”‚
â”‚ created_at, updated_at â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
             â”‚ 1:N                   â”‚
             â”‚                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚                       â”‚        â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚
â”‚     HYDROGRAPHS â­      â”‚ â”‚        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚        â”‚
â”‚ PK: id                â”‚ â”‚        â”‚
â”‚ FK: design_storm_id â—„â”€â”˜ â”‚        â”‚
â”‚ name                  â”‚   â”‚
â”‚ method                â”‚   â”‚
â”‚ peak_discharge_m3s    â”‚   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€ Almacena
â”‚ peak_discharge_lps    â”‚   â”‚         â”‚   resultados
â”‚ time_to_peak_minutes  â”‚   â”‚         â”‚
â”‚ total_runoff_mm       â”‚   â”‚         â”‚
â”‚ total_runoff_m3       â”‚   â”‚         â”‚
â”‚ volume_hm3            â”‚   â”‚         â”‚
â”‚ hydrograph_data (JSON)â”‚â—„â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ rainfall_excess_mm    â”‚   â”‚
â”‚ infiltration_total_mm â”‚   â”‚
â”‚ notes                 â”‚   â”‚
â”‚ created_at, updated_atâ”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                            â”‚
                            â”‚ (Opcional)
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚              â”‚
                â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ RAINFALL_DATA â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚ PK: id        â”‚
                â”‚ FK: watershed â”‚
                â”‚ event_date    â”‚
                â”‚ rainfall_mm   â”‚
                â”‚ rainfall_data â”‚
                â”‚ source        â”‚
                â”‚ created_at    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. FLUJO DE DATOS - CREAR ANÃLISIS COMPLETO

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                     USUARIO CREA NUEVO ANÃLISIS                     â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

PASO 1: Crear Proyecto
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/projects                   â”‚
â”‚ {                                       â”‚
â”‚   "name": "AmpliaciÃ³n Drenaje Norte",  â”‚
â”‚   "location": "Montevideo"              â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
   ğŸ“Š INSERT en: PROJECTS
            â†“
   âœ… Retorna: Project (id=2)

PASO 2: Crear Cuenca
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/projects/2/watersheds      â”‚
â”‚ {                                       â”‚
â”‚   "name": "Arroyo Pando",              â”‚
â”‚   "area_hectareas": 450,               â”‚
â”‚   "tc_horas": 2.2,                     â”‚
â”‚   "nc_scs": 70                         â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
   ğŸ“Š INSERT en: WATERSHEDS (project_id=2)
            â†“
   âœ… Retorna: Watershed (id=4)

PASO 3: Crear Tormenta #1 (DuraciÃ³n 2h)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/watersheds/4/design-storms â”‚
â”‚ {                                       â”‚
â”‚   "name": "Tr=10 AÃ±os 2h",             â”‚
â”‚   "return_period_years": 10,           â”‚
â”‚   "duration_hours": 2.0,               â”‚
â”‚   "total_rainfall_mm": 87.5            â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
   ğŸ“Š INSERT en: DESIGN_STORMS (watershed_id=4)
            â†“
   âœ… Retorna: DesignStorm (id=15)

PASO 3b: Crear Tormenta #2 (DuraciÃ³n 6h)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/watersheds/4/design-storms â”‚
â”‚ {                                       â”‚
â”‚   "name": "Tr=10 AÃ±os 6h",             â”‚
â”‚   "return_period_years": 10,           â”‚
â”‚   "duration_hours": 6.0,               â”‚
â”‚   "total_rainfall_mm": 105.2           â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
   ğŸ“Š INSERT en: DESIGN_STORMS (id=16)

   ... repetir para 12h (id=17) y 24h (id=18) ...

PASO 4: Calcular Hidrograma para tormenta 2h
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend calcula hidrograma      â”‚
â”‚ usando MÃ©todo SCS o Racional     â”‚
â”‚                                  â”‚
â”‚ Recibe: serie temporal con       â”‚
â”‚ {time_min, discharge_m3s, vol}  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/design-storms/15/hydrographs
â”‚ {                                       â”‚
â”‚   "method": "scs_alternating_block",   â”‚
â”‚   "peak_discharge_m3s": 125.45,        â”‚
â”‚   "total_runoff_m3": 294350,           â”‚
â”‚   "hydrograph_data": [                 â”‚
â”‚     {"time_min": 0, "discharge_m3s": 0, â”‚
â”‚     {"time_min": 5, "discharge_m3s": 2.45, â”‚
â”‚     ...                                â”‚
â”‚   ]                                    â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
   ğŸ“Š INSERT en: HYDROGRAPHS (design_storm_id=15)
       Guardando toda la serie temporal como JSON
            â†“
   âœ… Retorna: Hydrograph (id=101)

PASO 5: Repetir PASO 4 para tormentas 6h, 12h, 24h
   â†’ Genera: Hydrograph (id=102) para 6h
   â†’ Genera: Hydrograph (id=103) para 12h
   â†’ Genera: Hydrograph (id=104) para 24h

PASO 6: Comparar Hidrogramas
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/compare-hydrographs        â”‚
â”‚ {                                       â”‚
â”‚   "watershed_id": 4,                   â”‚
â”‚   "return_period_years": 10,           â”‚
â”‚   "durations_hours": [2, 6, 12, 24]   â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
   ğŸ“Š SELECT * FROM hydrographs
      JOIN design_storms
      WHERE design_storm.watershed_id = 4
      AND design_storm.duration_hours IN [2,6,12,24]
            â†“
   âœ… Retorna: ComparaciÃ³n con:
     - Todos los hidrogramas
     - EstadÃ­sticas (max, min, avg)
```

---

## 3. VISTA DE BASE DE DATOS COMPLETA

```
BASE DE DATOS: hidrocal.db (o PostgreSQL)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TABLA: projects                 (1 registro)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id  â”‚ name                      â”‚ location        â”‚ ...         â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1   â”‚ Sistema Drenaje Mvd       â”‚ Montevideo      â”‚ ...         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼ (1:N)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TABLA: watersheds               (3 registros)                   â”‚
â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id  â”‚ pr  â”‚ name             â”‚ area  â”‚ tc      â”‚ nc  â”‚ ...  â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1   â”‚ 1   â”‚ Miguelete Alto   â”‚ 250   â”‚ 1.8     â”‚ 72  â”‚      â”‚
â”‚ 2   â”‚ 1   â”‚ Carrasco Medio   â”‚ 180   â”‚ 1.5     â”‚ 75  â”‚      â”‚
â”‚ 3   â”‚ 1   â”‚ Arroyo Pantanoso â”‚ 320   â”‚ 2.1     â”‚ 68  â”‚      â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
         â–¼ (1:N)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TABLA: design_storms            (12 registros)                  â”‚
â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¤
â”‚ id  â”‚ wsâ”‚ name          â”‚ tr   â”‚ dura â”‚ rain   â”‚ dtyp â”‚...â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ 1   â”‚ 1 â”‚ Tr=10 2h      â”‚ 10   â”‚ 2.0  â”‚ 85.3   â”‚ ab   â”‚   â”‚
â”‚ 2   â”‚ 1 â”‚ Tr=10 6h      â”‚ 10   â”‚ 6.0  â”‚ 102.5  â”‚ ab   â”‚   â”‚
â”‚ 3   â”‚ 1 â”‚ Tr=10 12h     â”‚ 10   â”‚ 12.0 â”‚ 125.8  â”‚ ab   â”‚   â”‚
â”‚ 4   â”‚ 1 â”‚ Tr=10 24h     â”‚ 10   â”‚ 24.0 â”‚ 152.2  â”‚ ab   â”‚   â”‚
â”‚ ... â”‚...â”‚ ...           â”‚ ...  â”‚ ...  â”‚ ...    â”‚ ...  â”‚...|
â”‚ 13  â”‚ 2 â”‚ Tr=25 2h      â”‚ 25   â”‚ 2.0  â”‚ 96.2   â”‚ ab   â”‚   â”‚
â”‚ ... â”‚...â”‚ ...           â”‚ ...  â”‚ ...  â”‚ ...    â”‚ ...  â”‚...|
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜
         â–¼ (1:N)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TABLA: hydrographs              (12+ registros)                      â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id â”‚dsâ”‚ method   â”‚ peak_m3s  â”‚ t_pk â”‚ vol_m3   â”‚ hydro... â”‚ ...    â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚101 â”‚1 â”‚ scs_ab   â”‚ 125.45    â”‚ 42   â”‚ 294350   â”‚ [{0,0}...â”‚        â”‚
â”‚102 â”‚2 â”‚ scs_ab   â”‚ 98.23     â”‚ 68   â”‚ 472680   â”‚ [{0,0}...â”‚        â”‚
â”‚103 â”‚3 â”‚ scs_ab   â”‚ 72.15     â”‚ 115  â”‚ 635420   â”‚ [{0,0}...â”‚        â”‚
â”‚104 â”‚4 â”‚ scs_ab   â”‚ 45.20     â”‚ 185  â”‚ 768890   â”‚ [{0,0}...â”‚        â”‚
â”‚105 â”‚5 â”‚ rational â”‚ 156.32    â”‚ 38   â”‚ 285600   â”‚ [{0,0}...â”‚        â”‚
â”‚... â”‚..â”‚ ...      â”‚ ...       â”‚ ...  â”‚ ...      â”‚ ...      â”‚        â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Nota: hydrograph_data es un JSON con array:
[
  {"time_min": 0, "discharge_m3s": 0, "cumulative_volume_m3": 0},
  {"time_min": 5, "discharge_m3s": 2.45, "cumulative_volume_m3": 612.5},
  {"time_min": 10, "discharge_m3s": 5.82, "cumulative_volume_m3": 2150.3},
  ...
  {"time_min": 120, "discharge_m3s": 0.15, "cumulative_volume_m3": 294350}
]
```

---

## 4. COMPARACIÃ“N DE HIDROGRAMAS (Caso de Uso Principal)

```
Usuario solicita: "Comparar hidrogramas para diferentes duraciones"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/v1/compare-hydrographs â”‚
â”‚ {                                â”‚
â”‚   "watershed_id": 1,            â”‚
â”‚   "return_period_years": 10     â”‚
â”‚ }                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    ğŸ” Query: SELECT...

RESULTADO VISUAL (grÃ¡fico en UI):

        CAUDAL (mÂ³/s)
              â–²
        140   â”‚      â•±â•²         2h (Qmax=125.45)
              â”‚     â•±  â•²
        120   â”‚    â•±    â•²
              â”‚   â•±      â•²    6h (Qmax=98.23)
        100   â”‚  â•±        â•²  â•±â•²
              â”‚ â•±          â•²â•±  â•²
         80   â”‚â•±                â•²
              â”‚                  â•²   12h (Qmax=72.15)
         60   â”‚                   â•² â•±â•²
              â”‚                    â•±  â•²
         40   â”‚                   â•±    â•²
              â”‚                  â•±      â•² 24h (Qmax=45.20)
         20   â”‚                 â•±        â•²â•±
              â”‚                â•±
          0   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TIEMPO (min)
              0    30    60    90    120   150   180

TABLA COMPARATIVA:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DuraciÃ³n â”‚ Qmax     â”‚ Vol Total   â”‚ Tiempo Pico  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2 horas  â”‚ 125.45   â”‚ 294,350 mÂ³  â”‚ 42 min       â”‚
â”‚ 6 horas  â”‚ 98.23    â”‚ 472,680 mÂ³  â”‚ 68 min       â”‚
â”‚ 12 horas â”‚ 72.15    â”‚ 635,420 mÂ³  â”‚ 115 min      â”‚
â”‚ 24 horas â”‚ 45.20    â”‚ 768,890 mÂ³  â”‚ 185 min      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

INSIGHTS:
âœ“ Tormenta 2h â†’ Mayor pico, pero menor volumen (diseÃ±o de canal)
âœ“ Tormenta 24h â†’ Menor pico, mayor volumen (diseÃ±o de almacenamiento)
```

---

## 5. ARQUITECTURA TÃ‰CNICA DEL BACKEND

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND (HTML/JS)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ HTTP Requests (REST API)        â”‚
         â”‚                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FASTAPI (main.py)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Router /api/v1                                                 â”‚
â”‚ â”œâ”€â”€ projects (GET, POST, DELETE)                             â”‚
â”‚ â”œâ”€â”€ watersheds (GET, POST, DELETE)                           â”‚
â”‚ â”œâ”€â”€ design-storms (GET, POST, DELETE)                        â”‚
â”‚ â”œâ”€â”€ hydrographs (GET, POST, DELETE) â—„â”€â”€ Lo mÃ¡s importante   â”‚
â”‚ â””â”€â”€ compare-hydrographs (POST)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ api/routes.py         â”‚    â”‚ core/schemas.py           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ CRUD endpoints      â”‚    â”‚ â€¢ ValidaciÃ³n con Pydantic â”‚
â”‚ â€¢ LÃ³gica de rutas     â”‚    â”‚ â€¢ SerializaciÃ³n JSON      â”‚
â”‚ â€¢ Manejo de errores   â”‚    â”‚ â€¢ DocumentaciÃ³n automÃ¡tica â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ core/models.pyâ”‚  â”‚ database.py       â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ SQLAlchemy ORMâ”‚  â”‚ â€¢ ConexiÃ³n BD     â”‚
         â”‚ â€¢ Project     â”‚  â”‚ â€¢ SessionLocal()  â”‚
         â”‚ â€¢ Watershed   â”‚  â”‚ â€¢ get_db()        â”‚
         â”‚ â€¢ DesignStorm â”‚  â”‚ â€¢ Utilidades      â”‚
         â”‚ â€¢ Hydrograph  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                 â”‚                   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   BASE DE DATOS           â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚                          â”‚
              â”‚ Option A: SQLite         â”‚
              â”‚ â””â”€ hidrocal.db          â”‚
              â”‚                          â”‚
              â”‚ Option B: PostgreSQL     â”‚
              â”‚ â””â”€ hidrocal_db          â”‚
              â”‚                          â”‚
              â”‚ TABLAS:                  â”‚
              â”‚ â€¢ projects               â”‚
              â”‚ â€¢ watersheds             â”‚
              â”‚ â€¢ design_storms          â”‚
              â”‚ â€¢ hydrographs â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€ Almacena todo
              â”‚ â€¢ rainfall_data          â”‚
              â”‚                          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. CICLO DE VIDA DE UN HIDROGRAMA

```
ETAPA 1: CreaciÃ³n
   usuario â†’ Interface Web
       â†“
   Ingresa parÃ¡metros de cuenca
   Selecciona duraciÃ³n de tormenta
       â†“
   Frontend calcula hidrograma
   (MÃ©todo SCS o Racional)
       â†“

ETAPA 2: Almacenamiento
   Hidrograma calculado
       â†“
   POST /api/v1/design-storms/{id}/hydrographs
       â†“
   Backend valida con Pydantic
   Convierte datos a JSON
       â†“
   INSERT en BD (HYDROGRAPHS)
       â†“
   âœ… Hidrograma guardado permanentemente

ETAPA 3: RecuperaciÃ³n
   Usuario solicita:
   GET /api/v1/hydrographs/{id}
       â†“
   Backend busca en BD
       â†“
   Retorna JSON completo
   (con serie temporal)
       â†“

ETAPA 4: ComparaciÃ³n
   Usuario solicita:
   POST /api/v1/compare-hydrographs
   {watershed_id: 1, durations: [2,6,12,24]}
       â†“
   Backend:
   â€¢ SELECT hidrogramas con filtros
   â€¢ Calcula estadÃ­sticas
   â€¢ Retorna comparaciÃ³n
       â†“

ETAPA 5: VisualizaciÃ³n
   Frontend recibe datos
       â†“
   Dibuja grÃ¡ficos (Chart.js / Plotly)
   â€¢ LÃ­neas de hidrogramas
   â€¢ Tabla comparativa
   â€¢ EstadÃ­sticas
       â†“
   Usuario toma decisiones de diseÃ±o
```

---

Este diagrama muestra la **visiÃ³n completa** de cÃ³mo HidroCalc v2.0 gestiona datos
desde su creaciÃ³n hasta su comparaciÃ³n y anÃ¡lisis.

Â¿Alguna parte del diagrama que necesites clarificar?
